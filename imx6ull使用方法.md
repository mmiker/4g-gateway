# imx6ull使用方法

## 刷机

使用mfgtool刷机

## ssh 登陆

默认用户名：`root`，密码：`root`

## 网口

eth0和eth1都是使用的插上网线自动获取ip的方式
获取到IP后，可以用ping百度的方式进行测试

## SD卡

在SD卡卡槽内插入SD卡，SD卡会自动挂载到/run/media/mmcblk0p1目录下
可以进入到该目录下对SD卡内容进行操作

## CAN

```sh
cd /home/demo
./cantest can1
```

## 串口

```sh
cd /home/demo
RS232 com2
./serialtest /dev/ttymxc1
RS485 com4 com7
./serialtest /dev/ttymxc3
./serialtest /dev/ttymxc6
```

## LED

LED1为串口收发状态灯，有收发时会闪烁
LED2为电源指示灯，常亮
LED3为运行指示灯 GPIO4_16
LED4为4G网络状态灯，4G网络正常闪亮

```sh
echo 112 > /sys/class/gpio/export
echo out > /sys/class/gpio/gpio112/direction
echo 1 >  /sys/class/gpio/gpio112/value
```

## AI

AI2
cat /sys/devices/platform/soc/2100000.aips-bus/2198000.adc/iio:device0/in_voltage3
AI1
cat /sys/devices/platform/soc/2100000.aips-bus/2198000.adc/iio:device0/in_voltage4

## DO

```sh
echo 115 > /sys/class/gpio/export
echo out > /sys/class/gpio/gpio115/direction
echo 1 >  /sys/class/gpio/gpio115/value

echo 116 > /sys/class/gpio/export
echo out > /sys/class/gpio/gpio116/direction
echo 1 >  /sys/class/gpio/gpio116/value
```

## DI

```sh
echo 119 > /sys/class/gpio/export
echo in > /sys/class/gpio/gpio119/direction
cat /sys/class/gpio/gpio119/value
```

```sh
echo 120 > /sys/class/gpio/export
echo in > /sys/class/gpio/gpio120/direction
cat /sys/class/gpio/gpio120/value
```

```sh
echo 121 > /sys/class/gpio/export
echo in > /sys/class/gpio/gpio121/direction
cat /sys/class/gpio/gpio121/value
```

```sh
echo 122 > /sys/class/gpio/export
echo in > /sys/class/gpio/gpio122/direction
cat /sys/class/gpio/gpio122/value
```

```sh
echo 123 > /sys/class/gpio/export
echo in > /sys/class/gpio/gpio123/direction
cat /sys/class/gpio/gpio123/value
```

```sh
echo 124 > /sys/class/gpio/export
echo in > /sys/class/gpio/gpio124/direction
cat /sys/class/gpio/gpio124/value
```

```sh
echo 135 > /sys/class/gpio/export
echo in > /sys/class/gpio/gpio135/direction
cat /sys/class/gpio/gpio135/value
```

```sh
echo 136 > /sys/class/gpio/export
echo in > /sys/class/gpio/gpio136/direction
cat /sys/class/gpio/gpio136/value
```

## 4G 上网添加路由

```
route add default gw 10.64.64.64 metric 10
```

## 4G 添加 DNS

/etc/resolv.conf

```
# Generated by NetworkManager
nameserver 114.114.114.114
```

## 安装 cron

apt-get install cron
crontab -e

## pppd 断线重连

```sh
#!/bin/sh
#请把dns1,dns2修改成拼得通的DNS,开机自动运行,实时监控,断线自动重拨
dns1="8.8.8.8"
dns2="114.114.114.114"
sleep 8
#/bin/pppd call gprs-siem &
sleep 12
while true
do
    ping -s 1 -c 1 $dns1 #去PING第一个DNS
    if [ "$?" != "0" ] #假如PING不通
        then
        ping -s 1 -c 2 $dns2 #去PING第二个DNS
        if [ "$?" != "0" ] #假如PING不通
            then
            killall pppd #结束PPPD进程
            pppd call gprs-siem & #再去拨号
            sleep 12 #等待12秒
            sleep 5 #如果是PING DNS2通的话就直接等待5秒
        fi
        else
            sleep 5 #如果是PING DNS1通的话就直接等待5秒（一般要设置多长时间去PING请改这里）
        fi
done
```
